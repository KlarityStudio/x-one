!function($){"use strict";$.fluent=$.fluent||{},$.fluent.filter={filters:{},add:function(t,e){(this.filters[t]||(this.filters[t]=[])).push(e)},apply:function(t,e){if(this.filters[t])for(var n=this.filters[t],i=0;i<n.length&&(e=n[i](e),e!==!1);i++);return e}},$.fluent.is_clone_field=function(t){return t.attr("name")&&-1!=t.attr("name").indexOf("-clone##]")?!0:!1},$.fluent.layout=function(){("page"==fluent.context||"meta"==fluent.context)&&($(".wrap").addClass($(".options-layout-input:checked").val()),$(document).on("click",".options-layout-input",function(){var t=$(".options-layout-input:checked").val();$.post(ajaxurl,{action:"options_save_layout",options_layout:t,page:pagenow,screenoptionnonce:$("#screenoptionnonce").val()}),"options-normal"==t?$(".wrap").addClass("options-normal").removeClass("options-block"):$(".wrap").addClass("options-block").removeClass("options-normal")}))},$.fluent.restore=function(){$(document).on("click",".options-restore-default",function(){if($.fluent.proccess_required=!1,!confirm(fluent.L10n.warning_defaults))return!1;var t=$("<input>").attr("type","hidden").attr("name","restore-defaults").val("true");return $(".wrap form").append($(t)).submit(),$.fluent.proccess_required=!0,!1})},$.fluent.passes=!0,$.fluent.proccess_required=!0,$.fluent.required=function(){$(document).on("submit","form",function(){return $.fluent.proccess_required!==!1?($.fluent.passes=!0,$(document).trigger("fluent/pre_validate"),$.each(fluent.required,function(t,e){$(document).trigger("fluent/validate/"+e.type,[t,e])}),$(document).trigger("fluent/post_validate"),$.fluent.passes!==!0?($("#publish.button-primary-disabled").removeClass("button-primary-disabled"),$("#publishing-action .spinner").hide(),$(document).trigger("fluent/validation_failed"),$("tr.options-required input").first().focus(),!1):void $(document).trigger("fluent/validation_passed")):void 0})},$.fluent.required_postboxes=function(){$(".postbox").length>0&&$(".postbox").each(function(){$(this).find("tr.options-required").length>0?$(this).find("h3.hndle").addClass("options-required"):$(this).find("h3.hndle").removeClass("options-required")})},$.fluent.conditionals=function(){$(document).on("fluent/field/change",function(t,e){var n=$(e).closest("tr");$.each(fluent.conditionals,function(t,e){var i=$("tr#field-"+t);if(i.attr("id")!=n.attr("id")){var o=!1;$.each(e,function(t,e){var n=!0;return $.each(e,function(t,e){if($("tr#field-"+e.id).hasClass("condition-failed"))return n=!1,!1;var i=null;i=$.fluent.filter.apply("fluent/field/"+e.field_type+"/value",e.id),$.fluent.filter.apply("fluent/validate/"+e.type,{value:e.value,supplied:i})===!1&&(n=!1)}),n===!0?(o=!0,!1):void(n=!1)}),o===!1?i.closest("tr").fadeOut().addClass("condition-failed"):(o=!1,i.closest("tr").fadeIn().removeClass("condition-failed"))}})}),$(document).on("input change","input",function(){$(document).trigger("fluent/field/change",$(this))})},$(document).ready(function(){$.fluent.layout(),"page"==fluent.context&&(postboxes.add_postbox_toggles(pagenow),$.fluent.restore()),$.fluent.required(),$.fluent.conditionals(),$(document).on("fluent/validation_failed",function(){$.fluent.required_postboxes()}),$(document).on("fluent/created_fields",function(){$(".options-spinner").each(function(){$(this).fadeOut("fast",function(){$(this).closest("div").find(".options-table").fadeIn(),$(this).closest("div").find(".options-section-locked,.options-field-locked").fadeIn()})})}),$(document).on("click",".options-tabs-tabs > a",function(){if($(this).hasClass("active"))return!1;var t=$(this).attr("data-tab"),e=$(this).closest(".inside");e.find(".options-tabs-tabs a.active").removeClass("active"),$(this).addClass("active"),e.find(".options-tabs-tables .options-tab.active").removeClass("active"),e.find(".options-tabs-tables .options-tab#"+t).addClass("active");var n=$(this).parents("#post").find("input#post_ID").val(),i=$(this).parents(".postbox").attr("id");return localStorage.setItem("activeTab"+i+n,t),localStorage.setItem("parentPostBox"+i+n,i),!1}),$(document).on("fluent/validate/text fluent/validate/password fluent/validate/email fluent/validate/url fluent/validate/number fluent/validate/textarea fluent/validate/date fluent/validate/media fluent/validate/gallery",function(t,e,n){var i=n.msg;$.trim($(".options-table #"+e).val()).length||($(".options-table #"+e).closest("tr").hasClass("options-required")||($(".options-table #"+e).closest("tr").addClass("options-required"),$(".options-table #"+e).closest("td").append('<p class="description options-error">'+i+"</p>")),$.fluent.passes=!1),$(document).on("input",".options-table #"+e,function(){$.trim($(this).val()).length>0?$(this).closest("tr").hasClass("options-required")&&($(this).closest("tr").removeClass("options-required"),$("p.options-error",$(this).closest("td")).remove()):$(this).closest("tr").hasClass("options-required")||($(this).closest("tr").addClass("options-required"),$(this).closest("td").append('<p class="description options-error">'+i+"</p>"))})}),$(document).on("fluent/validate/checkbox",function(t,e,n){var i=n.msg;$(".options-table #field-"+e+' input[type="checkbox"]:checked').length||($(".options-table #field-"+e+' input[type="checkbox"]').closest("tr").hasClass("options-required")||($(".options-table #field-"+e+' input[type="checkbox"]').closest("tr").addClass("options-required"),$(".options-table #field-"+e+' input[type="checkbox"]').closest("td").append('<p class="description options-error">This is a required field!</p>')),$.fluent.passes=!1),$(document).on("change",".options-table #field-"+e+' input[type="checkbox"]',function(){$('input[type="checkbox"]:checked',$(this).closest("td")).length>0?$(this).closest("tr").hasClass("options-required")&&($(this).closest("tr").removeClass("options-required"),$("p.options-error",$(this).closest("td")).remove()):$(this).closest("tr").hasClass("options-required")||($(this).closest("tr").addClass("options-required"),$(this).closest("td").append('<p class="description options-error">'+i+"</p>"))})}),$(document).on("fluent/validate/editor",function(t,e,n){var i=n.msg;if("object"==typeof tinyMCE){tinyMCE.triggerSave();var o=$("#field-"+e).find(".wp-editor-area").attr("id"),s=tinyMCE.get(o);s&&!s.getContent()&&($(".options-table #"+e).closest("tr").hasClass("options-required")||($(".options-table #"+e).closest("tr").addClass("options-required"),$(".options-table #"+e).closest("td").append('<p class="description options-error">'+i+"</p>")),$.fluent.passes=!1)}})}),$(window).load(function(){setTimeout(function(){$(document).trigger("fluent/create_fields",[$(".wrap")]),$(document).trigger("fluent/created_fields",[$(".wrap")]),$(document).trigger("fluent/field/change",[$(".wrap")]),$(".wrap").find(".options-tabs-tabs,.options-section-description").fadeIn();var t=$("#post").find("input#post_ID").val();$(".wrap").addClass(t).find(".options-postbox").each(function(e,n){var i=$(this).attr("id"),o=localStorage.getItem("activeTab"+i+t),i=localStorage.getItem("parentPostBox"+i+t);if(null!=o||void 0!=o)$("#"+o).addClass("active"),$("[data-tab='"+o+"']").addClass("active");else{var s=$(this).find(".options-tab"),r=$(this).find(".options-tabs-tabs a");void 0!=s&&s.first().addClass("active"),void 0!=r&&r.first().addClass("active")}})},10)})}(jQuery),function($){"use strict";$.fluent=$.fluent||{},$.fluent.filter.add("fluent/validate/required",function(t){return""===t.supplied?!1:void 0}),$.fluent.filter.add("fluent/validate/==",function(t){return t.value!==t.supplied?!1:void 0}),$.fluent.filter.add("fluent/validate/!=",function(t){return t.value===t.supplied?!1:void 0}),$.fluent.filter.add("fluent/validate/contains",function(t){return-1===t.supplied.indexOf(t.value)?!1:void 0}),$.fluent.filter.add("fluent/validate/!contains",function(t){return""===t.supplied||t.supplied.indexOf(t.value)>=0?!1:void 0}),$.fluent.filter.add("fluent/validate/starts_with",function(t){return t.supplied.slice(0,t.value.length)!==t.value?!1:void 0}),$.fluent.filter.add("fluent/validate/ends_with",function(t){return t.supplied.slice(-t.value.length)!==t.value?!1:void 0}),$.fluent.filter.add("fluent/validate/>",function(t){return""===t.supplied||parseInt(t.supplied)<=parseInt(t.value)?!1:void 0}),$.fluent.filter.add("fluent/validate/>=",function(t){return""===t.supplied||parseInt(t.supplied)<parseInt(t.value)?!1:void 0}),$.fluent.filter.add("fluent/validate/<=",function(t){return""===t.supplied||parseInt(t.supplied)>parseInt(t.value)?!1:void 0}),$.fluent.filter.add("fluent/validate/<",function(t){return""===t.supplied||parseInt(t.supplied)>=parseInt(t.value)?!1:void 0}),$.fluent.filter.add("fluent/validate/between",function(t){var e=t.value.split("|");return""===t.supplied||parseInt(t.supplied)<parseInt(e[0])?!1:parseInt(t.supplied)>parseInt(e[1])?!1:void 0}),$.fluent.filter.add("fluent/validate/!between",function(t){var e=t.value.split("|");return""===t.supplied||parseInt(t.supplied)>parseInt(e[0])&&parseInt(t.supplied)<parseInt(e[1])?!1:void 0})}(jQuery),function($){"use strict";$.fluent=$.fluent||{},$.fluent.ace={$el:null,set:function(t){return $.extend(this,t),this},init:function(){if($.fluent.is_clone_field(this.$el))return!1;var t=$(this.$el),e=t.attr("data-ace-mode"),n=t.attr("data-ace-theme"),i=$("<div>",{position:"absolute",width:"100%",height:"200px","border-radius":"2px","class":t.attr("class")}).insertBefore(t);t.css("display","none");var o=ace.edit(i[0]);o.renderer.setShowGutter(!0),o.getSession().setValue(t.val()),o.getSession().setMode("ace/mode/"+e),o.setTheme("ace/theme/"+n),o.getSession().on("change",function(e){t.val(o.getSession().getValue()),$(document).trigger("fluent/field/change",$(t))})}},$(document).on("change",".field-type-ace textarea",function(){$(document).trigger("fluent/field/change",$(this))}),$.fluent.filter.add("fluent/field/ace/value",function(t){return $("#field-"+t).find("textarea").first().val()}),$(document).on("fluent/create_fields",function(t,e){$(e).find(".field-type-ace textarea").each(function(){$.fluent.ace.set({$el:$(this)}).init()})})}(jQuery),function($){"use strict";$.fluent=$.fluent||{},$.fluent.background={color:{$el:null,set:function(t){return $.extend(this,t),this},init:function(){return $.fluent.is_clone_field(this.$el)?!1:void $(this.$el).wpColorPicker({change:_.throttle(function(){$(this).trigger("change")},1e3)})}}},$(document).on("fluent/create_fields",function(t,e){$(e).find('.field-type-background input[type="text"].color').each(function(){$.fluent.background.color.set({$el:$(this)}).init()})}),$(document).on("fluent/field/change",function(){$(".field-type-background .options-media-id").each(function(){""===$(this).val()?$(this).closest(".field-type-background").find("tr.image").fadeOut():$(this).closest(".field-type-background").find("tr.image").fadeIn()})}),$(document).on("input",'.field-type-background input[type="text"].color',function(){$(document).trigger("fluent/field/change",$(this))})}(jQuery),function($){"use strict";$.fluent=$.fluent||{},$(document).on("change",".field-type-checkbox input",function(){$(document).trigger("fluent/field/change",$(this))}),$.fluent.filter.add("fluent/field/checkbox/value",function(t){var e=[];return $("#field-"+t).find('input[type="checkbox"]:checked').each($("#field-"+t).find('input[type="checkbox"]').length>1?function(t,n){e.push($(n).attr("name").split("][").pop().slice(0,-1))}:function(t,n){e.push($(n).val())}),e.join("|")})}(jQuery),function($){"use strict";$.fluent=$.fluent||{},$.fluent.color={$el:null,set:function(t){return $.extend(this,t),this},init:function(){return $.fluent.is_clone_field(this.$el)?!1:void $(this.$el).wpColorPicker({change:_.throttle(function(){$(this).trigger("change")},1e3)})}},$(document).on("fluent/create_fields",function(t,e){$(e).find('.field-type-color input[type="text"]').each(function(){$.fluent.color.set({$el:$(this)}).init()})}),$(document).on("input",'.field-type-color input[type="text"]',function(){$(document).trigger("fluent/field/change",$(this))}),$.fluent.filter.add("fluent/field/color/value",function(t){return $("#field-"+t).find('input[type="text"]').first().val()}),$(document).on("fluent/validate/color",function(t,e,n){var i=n.msg;$.trim($(".options-table #"+e).val()).length||($(".options-table #"+e).closest("tr").hasClass("options-required")||($(".options-table #"+e).closest("tr").addClass("options-required"),$(".options-table #"+e).closest("td").append('<p class="description options-error">'+i+"</p>")),$.fluent.passes=!1),$(document).on("click",".options-table #field-"+e+" *",function(){var t=$('input[type="text"]',$(this).closest("td"));$.trim($(t).val()).length>0?$(this).closest("tr").hasClass("options-required")&&($(this).closest("tr").removeClass("options-required"),$("p.options-error",$(this).closest("td")).remove()):$(this).closest("tr").hasClass("options-required")||($(this).closest("tr").addClass("options-required"),$(this).closest("td").append('<p class="description options-error">'+i+"</p>"))})})}(jQuery),function($){"use strict";$.fluent=$.fluent||{},$.fluent.date={$el:null,set:function(t){return $.extend(this,t),this},init:function(){return $.fluent.is_clone_field(this.$el)?!1:void $(this.$el).datepicker({onSelect:function(t,e){$(this).trigger("input")}})}},$(document).on("fluent/create_fields",function(t,e){$(e).find('.field-type-date input[type="text"]').each(function(){$.fluent.date.set({$el:$(this)}).init()})}),$(document).on("click",".field-type-date .dashicons",function(){$(this).prev("input").datepicker("show")}),$(document).on("input",'.field-type-date input[type="text"]',function(){$(document).trigger("fluent/field/change",$(this))}),$.fluent.filter.add("fluent/field/date/value",function(t){return $("#field-"+t).find('input[type="text"]').first().val()})}(jQuery),function($){"use strict";$.fluent=$.fluent||{},$(document).on("click keyup keydown focus",".field-type-editor, .field-type-editor *",function(){$(document).trigger("fluent/field/change",$(this).closest("tr"));var t=$(this).find("textarea.wp-editor-area").attr("id"),e=tinyMCE.get(t);e&&e.save()}),$.fluent.filter.add("fluent/field/editor/value",function(t){if($("#field-"+t).find("textarea.wp-editor-area").length>0&&"object"==typeof tinyMCE){var e=$("#field-"+t).find("textarea.wp-editor-area").attr("id"),n=tinyMCE.get(e);if(n)return n.getContent({format:"raw"})}return $("#field-"+t).find("textarea.wp-editor-area").first().val()})}(jQuery),function($){"use strict";$.fluent=$.fluent||{},$(document).on("input",'.field-type-email input[type="email"]',function(){$(document).trigger("fluent/field/change",$(this))}),$.fluent.filter.add("fluent/field/email/value",function(t){return $("#field-"+t).find('input[type="email"]').first().val()})}(jQuery),function($){"use strict";$.fluent=$.fluent||{},$(document).on("click",".field-type-export a",function(){return window.location.href=fluent.ajax_url+"?action=fluent_export&type="+fluent.context+"&option="+fluent.option_name+"&rel_id="+fluent.rel_id+"&_wpnonce="+fluent.nonce,!1})}(jQuery),function($){"use strict";$.fluent=$.fluent||{},$.fluent.font={color:{$el:null,set:function(t){return $.extend(this,t),this},init:function(){return $.fluent.is_clone_field(this.$el)?!1:void $(this.$el).wpColorPicker({change:_.throttle(function(){$(this).trigger("change")},1e3)})}},family:{$el:null,$instance:null,set:function(t){return $.extend(this,t),this},init:function(){if($.fluent.is_clone_field(this.$el))return!1;var t=$(this.$el).selectize({options:fluent_font,valueField:"name",labelField:"name",optgroupLabelField:"label",optgroupField:"optgroup",optgroups:[{value:"native",label:"Native Fonts"},{value:"google",label:"Google Fonts"}],searchField:["name"],create:!1,render:{option:function(t,e){name=t.name.replace(/\'/g,"");var n="google"==t.optgroup?' data-gfamily="'+t.family+'"':"";return'<div class="option" style="font-family: '+e(t.name)+' !important;"'+n+">"+e(name.split(",")[0])+"</div>"},item:function(t,e){return name=t.name.replace(/\'/g,""),'<div class="item" style="font-family: '+e(t.name)+' !important;">'+e(name.split(",")[0])+"</div>"}},onChange:function(t){$(document).trigger("fluent/field/font/preview",$(this.$el).closest(".field-type-font")),$(document).trigger("fluent/field/change")}});this.$instance=t.selectize,$(document).on("change input","#"+$(this.$el).closest(".field-type-font").closest("tr").attr("id")+" input,#"+$(this.$el).closest(".field-type-font").closest("tr").attr("id")+" select",function(){$(document).trigger("fluent/field/font/preview",$(this).closest(".field-type-font"))})}},loadremote:function(t){var e=$(t).closest(".selectize-control");$(".item[data-gfamily]:not(.loaded)",e).each(function(t,e){if(t>3)return!1;var n=$(e).attr("data-gfamily");""!==n&&-1===$.inArray(n,$.fluent.font.loadedgfonts)&&($("<link>").attr("rel","stylesheet").attr("type","text/css").attr("href","//fonts.googleapis.com/css?family="+n.replace(/ /g,"+")).appendTo("head"),$.fluent.font.loadedgfonts.push(n),$(e).addClass("loaded"))}),$(".option[data-gfamily]:not(.loaded)",e).each(function(t,e){if(t>3)return!1;var n=$(e).attr("data-gfamily");""!==n&&-1===$.inArray(n,$.fluent.font.loadedgfonts)&&($("<link>").attr("rel","stylesheet").attr("type","text/css").attr("href","//fonts.googleapis.com/css?family="+n.replace(/ /g,"+")).appendTo("head"),$.fluent.font.loadedgfonts.push(n),$(e).addClass("loaded"))})},loadedgfonts:[]},$(document).on("fluent/created_fields",function(){setTimeout(function(){$(".selectize-control").each(function(){$.fluent.font.loadremote($(this).find(".item").first())})},1e3)}),$(document).on("fluent/field/font/preview",function(){var t=$("select.font-family",this).val(),e=$('input[type="text"].color',this).val(),n=$('input[type="text"].line-height',this).val(),i=$('input[type="text"].font-size',this).val(),o=$('input[type="hidden"].units',this).val();$(".font-preview",this).css({"font-family":t,color:e,"line-height":n+o,"font-size":i+o})}),$(document).on("mouseenter",".field-type-font .font-family .option",function(){$.fluent.font.loadremote($(this))}),$(document).on("click",".field-type-font .bg-switcher",function(){$(this).hasClass("active")?($(this).closest(".font-preview").css({background:"#f9f9f9"}),$(this).removeClass("active")):($(this).closest(".font-preview").css({background:"#333"}),$(this).addClass("active"))}),$(document).on("fluent/create_fields",function(t,e){$(e).find('.field-type-font input[type="text"].color').each(function(){$.fluent.font.color.set({$el:$(this)}).init()}),$(e).find(".field-type-font select.font-family").each(function(){$.fluent.font.family.set({$el:$(this)}).init()})}),$(document).on("input",'.field-type-font input[type="text"].color',function(){$(document).trigger("fluent/field/change",$(this))}),$.fluent.filter.add("fluent/field/font/value",function(t){return $("#field-"+t).find("select").first().val()}),$(document).on("fluent/validate/font",function(t,e,n){var i=n.msg;$.trim($(".options-table #"+e).val()).length||($(".options-table #"+e).closest("tr").hasClass("options-required")||($(".options-table #"+e).closest("tr").addClass("options-required"),$(".options-table #"+e).closest("td").append('<p class="description options-error">'+i+"</p>")),$.fluent.passes=!1),$(document).on("click",".options-table #field-"+e+" *",function(){var t=$("select",$(this).closest("td"));$.trim($(t).val()).length>0?$(this).closest("tr").hasClass("options-required")&&($(this).closest("tr").removeClass("options-required"),$("p.options-error",$(this).closest("td")).remove()):$(this).closest("tr").hasClass("options-required")||($(this).closest("tr").addClass("options-required"),$(this).closest("td").append('<p class="description options-error">'+i+"</p>"))})})}(jQuery),function($){"use strict";$.fluent=$.fluent||{},$.fluent.gallery={$el:null,set:function(t){return $.extend(this,t),this},init:function(){$.fluent.gallery.sortable(),$(document).on("click",".field-type-gallery .options-gallery-remove",function(){var t=$(this).parent();return $(".options-gallery-images div",t).fadeOut(),$(".options-gallery-images",t).html("").removeClass("options-gallery-images-has-children"),$(".options-gallery-ids",t).val("").trigger("input"),!1}),$(document).on("click",".field-type-gallery .options-gallery-add-edit",function(){var t=$(this).parent(),e=$(".options-gallery-images",t),n=$(".options-gallery-ids",t),i=n.val(),o;o=i?'[gallery ids="'+i+'" className="test"]':'[gallery ids="0" className="test"]';var s=wp.media.gallery.edit(o);return s.content.get("view").sidebar.unset("gallery"),s.state("gallery-edit").on("update",function(t){e.html("").removeClass("options-gallery-images-has-children");var i,o="",s,r=t.models.map(function(t){return i=t.toJSON(),s="undefined"!=typeof i.sizes.thumbnail?i.sizes.thumbnail.url:i.url,o='<div class="options-gallery-thumb" data-id="'+i.id+'"><img src="'+s+'" /></div>',e.append(o),t.id});e.append('<div class="clearfix"></div>'),e.addClass("options-gallery-images-has-children"),n.val(r.join(",")).trigger("input"),$.acm.gallery.sortable()}),!1})},sortable:function(){$(".options-gallery-images").each(function(){$(this).sortable({update:function(t,e){var n=$(this).sortable("toArray",{attribute:"data-id"}),i=$(this).parent();$(".options-gallery-ids",i).val(n.join(","))}})})}},$(document).on("fluent/create_fields",function(t,e){$.fluent.gallery.init(),$.fluent.gallery.sortable()}),$(document).on("input",'.field-type-gallery input[type="hidden"]',function(){$(document).trigger("fluent/field/change",$(this))}),$.fluent.filter.add("fluent/field/gallery/value",function(t){return $("#field-"+t).find('input[type="hidden"]').first().val()})}(jQuery),function($){"use strict";$.fluent=$.fluent||{},$.fluent.group={$el:null,set:function(t){return $.extend(this,t),this},init:function(){},sortable:function(){$(".options-group-table > tbody").sortable({containment:"parent",handle:".options-group-move",helper:function(t,e){var n=e.children(),i=e.clone();return i.children().each(function(t){$(this).width(n.eq(t).width())}),i}})},table_width:function(){$(".options-group-table").each(function(){var t=$("> thead > tr > th.options-group-actions",$(this)).length;if(t>0){var e=$(this).width()-56;$("> thead > tr > th:not(.options-group-actions)",$(this)).each(function(){var t=$(this).attr("data-width")-20,n=e/100*t;$(this).css("width",Math.round(n)+"px")}),e=null}})},s4:function(){return Math.floor(65536*(1+Math.random())).toString(16).substring(1)},guid:function(){return this.s4()+this.s4()+"-"+this.s4()+"-"+this.s4()+"-"+this.s4()+"-"+this.s4()+this.s4()+this.s4()}},$(document).on("click",".options-group-add a",function(){var t=$(this).attr("data-id"),e="#"+t+"-template",n=new RegExp("##"+t+"-clone##","g"),i=$(e).html().replace(n,"i-"+$.fluent.group.guid());return $("#options-group-table-"+t+" > tbody").append(i),"horizontal"==$(this).attr("data-layout")?($(document).trigger("fluent/create_fields",$("#options-group-table-"+t+" > tbody tr:last-child")),$(document).trigger("fluent/created_fields",[$("#options-group-table-"+t+" > tbody tr:last-child")])):"vertical"==$(this).attr("data-layout")&&($(document).trigger("fluent/create_fields",$("#options-group-table-"+t+" > tbody tr:last-child").find("table")),$(document).trigger("fluent/created_fields",[$("#options-group-table-"+t+" > tbody tr:last-child").find("table")])),$.fluent.group.sortable(),!1}),$(document).on("click",".options-group-remove",function(){return $(this).closest("tr").find("td").slideUp("slow",function(){$(this).parent().remove()}),!1}),$(document).on("fluent/created_fields",function(t,e){$.fluent.group.sortable()})}(jQuery),function($){"use strict";$.fluent=$.fluent||{},$.fluent.import={$el:null,$frame:null,set:function(t){return $.extend(this,t),this},init:function(){$(document).on("click",".field-type-import .upload",function(){var t=$(this).closest(".field-type-import"),e=wp.media({className:"media-frame fluent-media-frame",frame:"select",multiple:!1,title:$(this).attr("data-title"),library:{type:"application/wpds"},button:{text:$(this).attr("data-select")}});return e.on("select",function(){var t=e.state().get("selection").first().toJSON();return e.close(),$.fluent.proccess_required=!1,$("#fluent-import-file").val(t.id),$(".wrap form").submit(),$.fluent.proccess_required=!0,!1}),e.open(),!1})}},$(document).on("fluent/create_fields",function(t,e){$.fluent.import.init()}),$.fluent.filter.add("fluent/field/import/value",function(t){return!1})}(jQuery),function($){"use strict";$.fluent=$.fluent||{},$.fluent.info={$el:null,set:function(t){return $.extend(this,t),this},init:function(){return $.fluent.is_clone_field(this.$el)?!1:($(this.$el).attr("colspan",2).addClass("info-type-"+$(this.$el).find("div[data-info-type]").data("info-type")),void("user"!=fluent.context?$(this.$el).closest("tr").find("td.label").hide():$(this.$el).closest("tr").find("th").hide()))}},$(document).on("fluent/create_fields",function(t,e){$(e).find(".field-type-info").each(function(){$.fluent.info.set({$el:$(this)}).init()})}),$(".wrap").find(".field-type-info").each(function(){$.fluent.info.set({$el:$(this)}).init()})}(jQuery),function($){"use strict";$.fluent=$.fluent||{},$.fluent.media={$el:null,$frame:null,set:function(t){return $.extend(this,t),this},init:function(){$(document).on("click",".field-type-media .upload",function(){var t=$(this).closest(".field-type-media"),e=wp.media({className:"media-frame avm-media-frame",frame:"select",multiple:!1,title:$(this).attr("data-title"),library:{},button:{text:$(this).attr("data-select")}});return e.on("select",function(){var n=e.state().get("selection").first().toJSON(),i=n.url;if("undefined"!=typeof n.sizes&&"undefined"!=typeof n.sizes.thumbnail)i=n.sizes.thumbnail.url;else if("undefined"!=typeof n.sizes){var o=n.height;for(var s in n.sizes){var r=n.sizes[s];r.height<o&&(o=r.height,i=r.url)}}else i=fluent_media.file_icon;$(".options-media-id",t).val(n.id).trigger("input"),$(".options-media-thumb > img",t).attr("src",i),$(".options-media-thumb > .options-media-edit",t).attr("href",n.editLink),$(".upload",t).fadeOut("slow",function(){$(".options-media-thumb",t).fadeIn()}),e.close()}),e.open(),!1}),$(document).on("click",".field-type-media .options-media-remove",function(){return $(this).parent().fadeOut("slow",function(){$(" img",this).attr("src","");var t=$(this).parent();$(".options-media-id",t).val("").trigger("input"),$(" .upload",t).fadeIn()}),!1})}},$(document).on("fluent/create_fields",function(t,e){$.fluent.media.init()}),$(document).on("input",'.field-type-media input[type="hidden"]',function(){$(document).trigger("fluent/field/change",$(this))}),$.fluent.filter.add("fluent/field/media/value",function(t){return $("#field-"+t).find('input[type="hidden"]').first().val()})}(jQuery),function($){"use strict";$.fluent=$.fluent||{},$(document).on("input",'.field-type-number input[type="number"]',function(){$(document).trigger("fluent/field/change",$(this))}),$.fluent.filter.add("fluent/field/number/value",function(t){return $("#field-"+t).find('input[type="number"]').first().val()})}(jQuery),function($){"use strict";$.fluent=$.fluent||{},$(document).on("input",'.field-type-password input[type="password"]',function(){$(document).trigger("fluent/field/change",$(this))}),$.fluent.filter.add("fluent/field/password/value",function(t){return $("#field-"+t).find('input[type="password"]').first().val()})}(jQuery),function($){"use strict";$.fluent=$.fluent||{},$(document).on("change click",".field-type-radio-img *",function(){$(this).closest("td").find("label").removeClass("checked"),$(this).closest("label").addClass("checked"),$(document).trigger("fluent/field/change",$(this))}),$.fluent.filter.add("fluent/field/radio-img/value",function(t){return $("#field-"+t).find('input[type="radio"]:checked').first().val()})}(jQuery),function($){"use strict";$.fluent=$.fluent||{},$(document).on("change",'.field-type-radio input[type="radio"]',function(){$(document).trigger("fluent/field/change",$(this))}),$.fluent.filter.add("fluent/field/radio/value",function(t){return $("#field-"+t).find('input[type="radio"]:checked').first().val()})}(jQuery),function($){"use strict";$.fluent=$.fluent||{},$(document).on("change",".field-type-search select",function(){$(document).trigger("fluent/field/change",$(this))}),$.fluent.filter.add("fluent/field/search/value",function(t){return $("#field-"+t).find("select").first().val()}),$(document).on("fluent/created_fields",function(){$(".options-table .selectize-search").each(function(t){var e=$(this).attr("data-value_key"),n=$(this).attr("data-value_label");$(this).selectize({valueField:e,labelField:n,searchField:[n],options:[{id:1,title:"test"},{id:2,title:"test2"}],create:!1,onChange:function(t){$(document).trigger("fluent/field/change")},load:function(t,e){return t.length?void $.ajax({url:$(this.$input[0]).attr("data-search_url"),type:"POST",data:{q:t,source:$(this.$input[0]).attr("data-source_type"),post_types:$(this.$input[0]).attr("data-post_types"),roles:$(this.$input[0]).attr("data-roles"),key:$(this.$input[0]).attr("data-value_key"),label:$(this.$input[0]).attr("data-value_label")},error:function(){console.log("search field error"),e()},success:function(t){var n=$.parseJSON(t);console.log(n),e(n)}}):e()}})})})}(jQuery),function($){"use strict";$.fluent=$.fluent||{},$(document).on("change",".field-type-select select",function(){$(document).trigger("fluent/field/change",$(this))}),$.fluent.filter.add("fluent/field/select/value",function(t){return $("#field-"+t).find("select").first().val()}),$(document).on("fluent/created_fields",function(){$(".options-table .selectize").selectize({plugins:["remove_button"],delimiter:",",persist:!1,create:function(t){return{value:t,text:t}},onChange:function(t){$(document).trigger("fluent/field/change")}})})}(jQuery),function($){"use strict";$.fluent=$.fluent||{},$.fluent.switch={$el:null,set:function(t){return $.extend(this,t),this},init:function(){return $.fluent.is_clone_field(this.$el)?!1:void $(this.$el).toggleSwitch({highlight:!0,width:30})}},$(document).on("fluent/create_fields",function(t,e){$(e).find(".field-type-switch .toggle-switch").each(function(){$.fluent.switch.set({$el:$(this)}).init()})}),$(document).on("change",".field-type-switch select",function(){$(document).trigger("fluent/field/change",$(this))}),$.fluent.filter.add("fluent/field/switch/value",function(t){return $("#field-"+t).find("select").first().val()}),jQuery.fn.toggleSwitch=function(t){function e(t){function e(t,e){var n=$(t),i=n.parent();n.find("label").eq(e).addClass("ui-state-active").siblings("label").removeClass("ui-state-active"),i.find("option").prop("selected",!1).eq(e).prop("selected",!0),i.find("select").trigger("change"),n.find(".ui-slider").slider("value",52*e)}var n=$("<div />").addClass("ui-toggle-switch");$(t).find("option").each(function(t,e){n.append("<label>"+$(e).text()+"</label>")}).end().addClass("ui-toggle-switch");var o=$("<div />").slider({min:0,max:100,animate:"fast",change:i.change,stop:function(t,n){var o=Math.round(n.value/100),s=this;window.setTimeout(function(){e(s.parentNode,o)},11),"function"==typeof i.stop&&i.stop.call(this,t,o)},range:i.highlight&&!$(t).data("hideHighlight")?"max":null}).width(i.width);o.insertAfter(n.children().eq(0)),n.on("click","label",function(){if(!$(this).hasClass("ui-state-active")){var t=$(this).is(":first-child")?0:1;e(this.parentNode,t)}}),n.find("label").eq(t.selectedIndex).click(),$(t).parent().append(n)}var n={highlight:!0,width:30,change:null,stop:null},i=$.extend({},n,t);return $(this).each(function(t,n){e(n)})}}(jQuery),function($){"use strict";$.fluent=$.fluent||{},$(document).on("input",'.field-type-text input[type="text"]',function(){$(document).trigger("fluent/field/change",$(this))}),$.fluent.filter.add("fluent/field/text/value",function(t){return $("#field-"+t).find('input[type="text"]').first().val()})}(jQuery),function($){"use strict";$.fluent=$.fluent||{},$(document).on("input",".field-type-textarea textarea",function(){$(document).trigger("fluent/field/change",$(this))
}),$.fluent.filter.add("fluent/field/textarea/value",function(t){return $("#field-"+t).find("textarea").first().val()})}(jQuery),function($){"use strict";$.fluent=$.fluent||{},$(document).on("input",'.field-type-url input[type="url"]',function(){$(document).trigger("fluent/field/change",$(this))}),$.fluent.filter.add("fluent/field/url/value",function(t){return $("#field-"+t).find('input[type="url"]').first().val()})}(jQuery),function(t,e){"function"==typeof define&&define.amd?define("sifter",e):"object"==typeof exports?module.exports=e():t.Sifter=e()}(this,function(){var t=function(t,e){this.items=t,this.settings=e||{diacritics:!0}};t.prototype.tokenize=function(t){if(t=i(String(t||"").toLowerCase()),!t||!t.length)return[];var e,n,s,l,a=[],u=t.split(/ +/);for(e=0,n=u.length;n>e;e++){if(s=o(u[e]),this.settings.diacritics)for(l in r)r.hasOwnProperty(l)&&(s=s.replace(new RegExp(l,"g"),r[l]));a.push({string:u[e],regex:new RegExp(s,"i")})}return a},t.prototype.iterator=function(t,e){var n;n=s(t)?Array.prototype.forEach||function(t){for(var e=0,n=this.length;n>e;e++)t(this[e],e,this)}:function(t){for(var e in this)this.hasOwnProperty(e)&&t(this[e],e,this)},n.apply(t,[e])},t.prototype.getScoreFunction=function(t,e){var n,i,o,s;n=this,t=n.prepareSearch(t,e),o=t.tokens,i=t.options.fields,s=o.length;var r=function(t,e){var n,i;return t?(t=String(t||""),i=t.search(e.regex),-1===i?0:(n=e.string.length/t.length,0===i&&(n+=.5),n)):0},l=function(){var t=i.length;return t?1===t?function(t,e){return r(e[i[0]],t)}:function(e,n){for(var o=0,s=0;t>o;o++)s+=r(n[i[o]],e);return s/t}:function(){return 0}}();return s?1===s?function(t){return l(o[0],t)}:"and"===t.options.conjunction?function(t){for(var e,n=0,i=0;s>n;n++){if(e=l(o[n],t),0>=e)return 0;i+=e}return i/s}:function(t){for(var e=0,n=0;s>e;e++)n+=l(o[e],t);return n/s}:function(){return 0}},t.prototype.getSortFunction=function(t,n){var i,o,s,r,l,a,u,d,c,p,f;if(s=this,t=s.prepareSearch(t,n),f=!t.query&&n.sort_empty||n.sort,c=function(t,e){return"$score"===t?e.score:s.items[e.id][t]},l=[],f)for(i=0,o=f.length;o>i;i++)(t.query||"$score"!==f[i].field)&&l.push(f[i]);if(t.query){for(p=!0,i=0,o=l.length;o>i;i++)if("$score"===l[i].field){p=!1;break}p&&l.unshift({field:"$score",direction:"desc"})}else for(i=0,o=l.length;o>i;i++)if("$score"===l[i].field){l.splice(i,1);break}for(d=[],i=0,o=l.length;o>i;i++)d.push("desc"===l[i].direction?-1:1);return a=l.length,a?1===a?(r=l[0].field,u=d[0],function(t,n){return u*e(c(r,t),c(r,n))}):function(t,n){var i,o,s,r,u;for(i=0;a>i;i++)if(u=l[i].field,o=d[i]*e(c(u,t),c(u,n)))return o;return 0}:null},t.prototype.prepareSearch=function(t,e){if("object"==typeof t)return t;e=n({},e);var i=e.fields,o=e.sort,r=e.sort_empty;return i&&!s(i)&&(e.fields=[i]),o&&!s(o)&&(e.sort=[o]),r&&!s(r)&&(e.sort_empty=[r]),{options:e,query:String(t||"").toLowerCase(),tokens:this.tokenize(t),total:0,items:[]}},t.prototype.search=function(t,e){var n=this,i,o,s,r,l,a;return s=this.prepareSearch(t,e),e=s.options,t=s.query,a=e.score||n.getScoreFunction(s),t.length?n.iterator(n.items,function(t,n){o=a(t),(e.filter===!1||o>0)&&s.items.push({score:o,id:n})}):n.iterator(n.items,function(t,e){s.items.push({score:1,id:e})}),l=n.getSortFunction(s,e),l&&s.items.sort(l),s.total=s.items.length,"number"==typeof e.limit&&(s.items=s.items.slice(0,e.limit)),s};var e=function(t,e){return"number"==typeof t&&"number"==typeof e?t>e?1:e>t?-1:0:(t=String(t||"").toLowerCase(),e=String(e||"").toLowerCase(),t>e?1:e>t?-1:0)},n=function(t,e){var n,i,o,s;for(n=1,i=arguments.length;i>n;n++)if(s=arguments[n])for(o in s)s.hasOwnProperty(o)&&(t[o]=s[o]);return t},i=function(t){return(t+"").replace(/^\s+|\s+$|/g,"")},o=function(t){return(t+"").replace(/([.?*+^$[\]\\(){}|-])/g,"\\$1")},s=Array.isArray||$&&$.isArray||function(t){return"[object Array]"===Object.prototype.toString.call(t)},r={a:"[aÀÁÂÃÄÅàáâãäå]",c:"[cÇçćĆčČ]",d:"[dđĐ]",e:"[eÈÉÊËèéêë]",i:"[iÌÍÎÏìíîï]",n:"[nÑñ]",o:"[oÒÓÔÕÕÖØòóôõöø]",s:"[sŠš]",u:"[uÙÚÛÜùúûü]",y:"[yŸÿý]",z:"[zŽž]"};return t}),function(t,e){"function"==typeof define&&define.amd?define("microplugin",e):"object"==typeof exports?module.exports=e():t.MicroPlugin=e()}(this,function(){var t={};t.mixin=function(t){t.plugins={},t.prototype.initializePlugins=function(t){var n,i,o,s=this,r=[];if(s.plugins={names:[],settings:{},requested:{},loaded:{}},e.isArray(t))for(n=0,i=t.length;i>n;n++)"string"==typeof t[n]?r.push(t[n]):(s.plugins.settings[t[n].name]=t[n].options,r.push(t[n].name));else if(t)for(o in t)t.hasOwnProperty(o)&&(s.plugins.settings[o]=t[o],r.push(o));for(;r.length;)s.require(r.shift())},t.prototype.loadPlugin=function(e){var n=this,i=n.plugins,o=t.plugins[e];if(!t.plugins.hasOwnProperty(e))throw new Error('Unable to find "'+e+'" plugin');i.requested[e]=!0,i.loaded[e]=o.fn.apply(n,[n.plugins.settings[e]||{}]),i.names.push(e)},t.prototype.require=function(t){var e=this,n=e.plugins;if(!e.plugins.loaded.hasOwnProperty(t)){if(n.requested[t])throw new Error('Plugin has circular dependency ("'+t+'")');e.loadPlugin(t)}return n.loaded[t]},t.define=function(e,n){t.plugins[e]={name:e,fn:n}}};var e={isArray:Array.isArray||function(t){return"[object Array]"===Object.prototype.toString.call(t)}};return t}),function(t,e){"function"==typeof define&&define.amd?define("selectize",["jquery","sifter","microplugin"],e):t.Selectize=e(t.jQuery,t.Sifter,t.MicroPlugin)}(this,function($,t,e){"use strict";var n=function(t,e){if("string"!=typeof e||e.length){var n="string"==typeof e?new RegExp(e,"i"):e,i=function(t){var e=0;if(3===t.nodeType){var o=t.data.search(n);if(o>=0&&t.data.length>0){var s=t.data.match(n),r=document.createElement("span");r.className="highlight";var l=t.splitText(o),a=l.splitText(s[0].length),u=l.cloneNode(!0);r.appendChild(u),l.parentNode.replaceChild(r,l),e=1}}else if(1===t.nodeType&&t.childNodes&&!/(script|style)/i.test(t.tagName))for(var d=0;d<t.childNodes.length;++d)d+=i(t.childNodes[d]);return e};return t.each(function(){i(this)})}},i=function(){};i.prototype={on:function(t,e){this._events=this._events||{},this._events[t]=this._events[t]||[],this._events[t].push(e)},off:function(t,e){var n=arguments.length;return 0===n?delete this._events:1===n?delete this._events[t]:(this._events=this._events||{},void(t in this._events!=!1&&this._events[t].splice(this._events[t].indexOf(e),1)))},trigger:function(t){if(this._events=this._events||{},t in this._events!=!1)for(var e=0;e<this._events[t].length;e++)this._events[t][e].apply(this,Array.prototype.slice.call(arguments,1))}},i.mixin=function(t){for(var e=["on","off","trigger"],n=0;n<e.length;n++)t.prototype[e[n]]=i.prototype[e[n]]};var o=/Mac/.test(navigator.userAgent),s=65,r=188,l=13,a=27,u=37,d=38,c=39,p=40,f=8,h=46,g=16,v=o?91:17,m=o?18:17,y=9,b=1,w=2,C=function(t){return"undefined"!=typeof t},x=function(t){return"undefined"==typeof t||null===t?"":"boolean"==typeof t?t?"1":"0":t+""},_=function(t){return(t+"").replace(/&/g,"&amp;").replace(/</g,"&lt;").replace(/>/g,"&gt;").replace(/"/g,"&quot;")},O=function(t){return(t+"").replace(/\$/g,"$$$$")},k={};k.before=function(t,e,n){var i=t[e];t[e]=function(){return n.apply(t,arguments),i.apply(t,arguments)}},k.after=function(t,e,n){var i=t[e];t[e]=function(){var e=i.apply(t,arguments);return n.apply(t,arguments),e}};var I=function(t,e){if(!$.isArray(e))return e;var n,i,o={};for(n=0,i=e.length;i>n;n++)e[n].hasOwnProperty(t)&&(o[e[n][t]]=e[n]);return o},S=function(t){var e=!1;return function(){e||(e=!0,t.apply(this,arguments))}},q=function(t,e){var n;return function(){var i=this,o=arguments;window.clearTimeout(n),n=window.setTimeout(function(){t.apply(i,o)},e)}},F=function(t,e,n){var i,o=t.trigger,s={};t.trigger=function(){var n=arguments[0];return-1===e.indexOf(n)?o.apply(t,arguments):void(s[n]=arguments)},n.apply(t,[]),t.trigger=o;for(i in s)s.hasOwnProperty(i)&&o.apply(t,s[i])},j=function(t,e,n,i){t.on(e,n,function(e){for(var n=e.target;n&&n.parentNode!==t[0];)n=n.parentNode;return e.currentTarget=n,i.apply(this,[e])})},D=function(t){var e={};if("selectionStart"in t)e.start=t.selectionStart,e.length=t.selectionEnd-e.start;else if(document.selection){t.focus();var n=document.selection.createRange(),i=document.selection.createRange().text.length;n.moveStart("character",-t.value.length),e.start=n.text.length-i,e.length=i}return e},A=function(t,e,n){var i,o,s={};if(n)for(i=0,o=n.length;o>i;i++)s[n[i]]=t.css(n[i]);else s=t.css();e.css(s)},z=function(t,e){var n=$("<test>").css({position:"absolute",top:-99999,left:-99999,width:"auto",padding:0,whiteSpace:"pre"}).text(t).appendTo("body");A(e,n,["letterSpacing","fontSize","fontFamily","fontWeight","textTransform"]);var i=n.width();return n.remove(),i},P=function(t){var e=function(e){var n,i,o,s,r,l,a,u;e=e||window.event||{},e.metaKey||e.altKey||t.data("grow")!==!1&&(n=t.val(),e.type&&"keydown"===e.type.toLowerCase()&&(i=e.keyCode,o=i>=97&&122>=i||i>=65&&90>=i||i>=48&&57>=i||32===i,i===h||i===f?(u=D(t[0]),u.length?n=n.substring(0,u.start)+n.substring(u.start+u.length):i===f&&u.start?n=n.substring(0,u.start-1)+n.substring(u.start+1):i===h&&"undefined"!=typeof u.start&&(n=n.substring(0,u.start)+n.substring(u.start+1))):o&&(l=e.shiftKey,a=String.fromCharCode(e.keyCode),a=l?a.toUpperCase():a.toLowerCase(),n+=a)),s=t.attr("placeholder")||"",!n.length&&s.length&&(n=s),r=z(n,t)+4,r!==t.width()&&(t.width(r),t.triggerHandler("resize")))};t.on("keydown keyup update blur",e),e()},T=function(e,n){var i,o,s,r,l,a=this;l=e[0],l.selectize=a,r=window.getComputedStyle?window.getComputedStyle(l,null).getPropertyValue("direction"):l.currentStyle&&l.currentStyle.direction,r=r||e.parents("[dir]:first").attr("dir")||"",$.extend(a,{settings:n,$input:e,tagType:"select"===l.tagName.toLowerCase()?b:w,rtl:/rtl/i.test(r),eventNS:".selectize"+ ++T.count,highlightedValue:null,isOpen:!1,isDisabled:!1,isRequired:e.is("[required]"),isInvalid:!1,isLocked:!1,isFocused:!1,isInputHidden:!1,isSetup:!1,isShiftDown:!1,isCmdDown:!1,isCtrlDown:!1,ignoreFocus:!1,ignoreHover:!1,hasOptions:!1,currentResults:null,lastValue:"",caretPos:0,loading:0,loadedSearches:{},$activeOption:null,$activeItems:[],optgroups:{},options:{},userOptions:{},items:[],renderCache:{},onSearchChange:q(a.onSearchChange,n.loadThrottle)}),a.sifter=new t(this.options,{diacritics:n.diacritics}),$.extend(a.options,I(n.valueField,n.options)),delete a.settings.options,$.extend(a.optgroups,I(n.optgroupValueField,n.optgroups)),delete a.settings.optgroups,a.settings.mode=a.settings.mode||(1===a.settings.maxItems?"single":"multi"),"boolean"!=typeof a.settings.hideSelected&&(a.settings.hideSelected="multi"===a.settings.mode),a.initializePlugins(a.settings.plugins),a.setupCallbacks(),a.setupTemplates(),a.setup()};return i.mixin(T),e.mixin(T),$.extend(T.prototype,{setup:function(){var t=this,e=t.settings,n=t.eventNS,i=$(window),s=$(document),r,l,a,u,d,c,p,f,h,y,w,C;p=t.settings.mode,y=t.$input.attr("tabindex")||"",w=t.$input.attr("class")||"",r=$("<div>").addClass(e.wrapperClass).addClass(w).addClass(p),l=$("<div>").addClass(e.inputClass).addClass("items").appendTo(r),a=$('<input type="text" autocomplete="off">').appendTo(l).attr("tabindex",y),c=$(e.dropdownParent||r),u=$("<div>").addClass(e.dropdownClass).addClass(w).addClass(p).hide().appendTo(c),d=$("<div>").addClass(e.dropdownContentClass).appendTo(u),r.css({width:t.$input[0].style.width}),t.plugins.names.length&&(C="plugin-"+t.plugins.names.join(" plugin-"),r.addClass(C),u.addClass(C)),(null===e.maxItems||e.maxItems>1)&&t.tagType===b&&t.$input.attr("multiple","multiple"),t.settings.placeholder&&a.attr("placeholder",e.placeholder),t.$wrapper=r,t.$control=l,t.$control_input=a,t.$dropdown=u,t.$dropdown_content=d,u.on("mouseenter","[data-selectable]",function(){return t.onOptionHover.apply(t,arguments)}),u.on("mousedown","[data-selectable]",function(){return t.onOptionSelect.apply(t,arguments)}),j(l,"mousedown","*:not(input)",function(){return t.onItemSelect.apply(t,arguments)}),P(a),l.on({mousedown:function(){return t.onMouseDown.apply(t,arguments)},click:function(){return t.onClick.apply(t,arguments)}}),a.on({mousedown:function(t){t.stopPropagation()},keydown:function(){return t.onKeyDown.apply(t,arguments)},keyup:function(){return t.onKeyUp.apply(t,arguments)},keypress:function(){return t.onKeyPress.apply(t,arguments)},resize:function(){t.positionDropdown.apply(t,[])},blur:function(){return t.onBlur.apply(t,arguments)},focus:function(){return t.onFocus.apply(t,arguments)}}),s.on("keydown"+n,function(e){t.isCmdDown=e[o?"metaKey":"ctrlKey"],t.isCtrlDown=e[o?"altKey":"ctrlKey"],t.isShiftDown=e.shiftKey}),s.on("keyup"+n,function(e){e.keyCode===m&&(t.isCtrlDown=!1),e.keyCode===g&&(t.isShiftDown=!1),e.keyCode===v&&(t.isCmdDown=!1)}),s.on("mousedown"+n,function(e){if(t.isFocused){if(e.target===t.$dropdown[0]||e.target.parentNode===t.$dropdown[0])return!1;t.$control.has(e.target).length||e.target===t.$control[0]||t.blur()}}),i.on(["scroll"+n,"resize"+n].join(" "),function(){t.isOpen&&t.positionDropdown.apply(t,arguments)}),i.on("mousemove"+n,function(){t.ignoreHover=!1}),this.revertSettings={$children:t.$input.children().detach(),tabindex:t.$input.attr("tabindex")},t.$input.attr("tabindex",-1).hide().after(t.$wrapper),$.isArray(e.items)&&(t.setValue(e.items),delete e.items),t.$input[0].validity&&t.$input.on("invalid"+n,function(e){e.preventDefault(),t.isInvalid=!0,t.refreshState()}),t.updateOriginalInput(),t.refreshItems(),t.refreshState(),t.updatePlaceholder(),t.isSetup=!0,t.$input.is(":disabled")&&t.disable(),t.on("change",this.onChange),t.trigger("initialize"),e.preload&&t.onSearchChange("")},setupTemplates:function(){var t=this,e=t.settings.labelField,n=t.settings.optgroupLabelField,i={optgroup:function(t){return'<div class="optgroup">'+t.html+"</div>"},optgroup_header:function(t,e){return'<div class="optgroup-header">'+e(t[n])+"</div>"},option:function(t,n){return'<div class="option">'+n(t[e])+"</div>"},item:function(t,n){return'<div class="item">'+n(t[e])+"</div>"},option_create:function(t,e){return'<div class="create">Add <strong>'+e(t.input)+"</strong>&hellip;</div>"}};t.settings.render=$.extend({},i,t.settings.render)},setupCallbacks:function(){var t,e,n={initialize:"onInitialize",change:"onChange",item_add:"onItemAdd",item_remove:"onItemRemove",clear:"onClear",option_add:"onOptionAdd",option_remove:"onOptionRemove",option_clear:"onOptionClear",dropdown_open:"onDropdownOpen",dropdown_close:"onDropdownClose",type:"onType"};for(t in n)n.hasOwnProperty(t)&&(e=this.settings[n[t]],e&&this.on(t,e))},onClick:function(t){var e=this;e.isFocused||(e.focus(),t.preventDefault())},onMouseDown:function(t){var e=this,n=t.isDefaultPrevented(),i=$(t.target);if(e.isFocused){if(t.target!==e.$control_input[0])return"single"===e.settings.mode?e.isOpen?e.close():e.open():n||e.setActiveItem(null),!1}else n||window.setTimeout(function(){e.focus()},0)},onChange:function(){this.$input.trigger("change")},onKeyPress:function(t){if(this.isLocked)return t&&t.preventDefault();var e=String.fromCharCode(t.keyCode||t.which);return this.settings.create&&e===this.settings.delimiter?(this.createItem(),t.preventDefault(),!1):void 0},onKeyDown:function(t){var e=t.target===this.$control_input[0],n=this;if(n.isLocked)return void(t.keyCode!==y&&t.preventDefault());switch(t.keyCode){case s:if(n.isCmdDown)return void n.selectAll();break;case a:return void n.close();case p:if(!n.isOpen&&n.hasOptions)n.open();else if(n.$activeOption){n.ignoreHover=!0;var i=n.getAdjacentOption(n.$activeOption,1);i.length&&n.setActiveOption(i,!0,!0)}return void t.preventDefault();case d:if(n.$activeOption){n.ignoreHover=!0;var o=n.getAdjacentOption(n.$activeOption,-1);o.length&&n.setActiveOption(o,!0,!0)}return void t.preventDefault();case l:return n.isOpen&&n.$activeOption&&n.onOptionSelect({currentTarget:n.$activeOption}),void t.preventDefault();case u:return void n.advanceSelection(-1,t);case c:return void n.advanceSelection(1,t);case y:return void(n.settings.create&&n.createItem()&&t.preventDefault());case f:case h:return void n.deleteSelection(t)}return n.isFull()||n.isInputHidden?void t.preventDefault():void 0},onKeyUp:function(t){var e=this;if(e.isLocked)return t&&t.preventDefault();var n=e.$control_input.val()||"";e.lastValue!==n&&(e.lastValue=n,e.onSearchChange(n),e.refreshOptions(),e.trigger("type",n))},onSearchChange:function(t){var e=this,n=e.settings.load;n&&(e.loadedSearches.hasOwnProperty(t)||(e.loadedSearches[t]=!0,e.load(function(i){n.apply(e,[t,i])})))},onFocus:function(t){var e=this;return e.isFocused=!0,e.isDisabled?(e.blur(),t&&t.preventDefault(),!1):void(e.ignoreFocus||("focus"===e.settings.preload&&e.onSearchChange(""),e.$activeItems.length||(e.showInput(),e.setActiveItem(null),e.refreshOptions(!!e.settings.openOnFocus)),e.refreshState()))},onBlur:function(t){var e=this;e.isFocused=!1,e.ignoreFocus||(e.settings.create&&e.settings.createOnBlur&&e.createItem(),e.close(),e.setTextboxValue(""),e.setActiveItem(null),e.setActiveOption(null),e.setCaret(e.items.length),e.refreshState())},onOptionHover:function(t){this.ignoreHover||this.setActiveOption(t.currentTarget,!1)},onOptionSelect:function(t){var e,n,i,o=this;t.preventDefault&&(t.preventDefault(),t.stopPropagation()),n=$(t.currentTarget),n.hasClass("create")?o.createItem():(e=n.attr("data-value"),e&&(o.lastQuery=null,o.setTextboxValue(""),o.addItem(e),!o.settings.hideSelected&&t.type&&/mouse/.test(t.type)&&o.setActiveOption(o.getOption(e))))},onItemSelect:function(t){var e=this;e.isLocked||"multi"===e.settings.mode&&(t.preventDefault(),e.setActiveItem(t.currentTarget,t))},load:function(t){var e=this,n=e.$wrapper.addClass("loading");e.loading++,t.apply(e,[function(t){e.loading=Math.max(e.loading-1,0),t&&t.length&&(e.addOption(t),e.refreshOptions(e.isFocused&&!e.isInputHidden)),e.loading||n.removeClass("loading"),e.trigger("load",t)}])},setTextboxValue:function(t){this.$control_input.val(t).triggerHandler("update"),this.lastValue=t},getValue:function(){return this.tagType===b&&this.$input.attr("multiple")?this.items:this.items.join(this.settings.delimiter)},setValue:function(t){F(this,["change"],function(){this.clear();for(var e=$.isArray(t)?t:[t],n=0,i=e.length;i>n;n++)this.addItem(e[n])})},setActiveItem:function(t,e){var n=this,i,o,s,r,l,a,u,d;if("single"!==n.settings.mode){if(t=$(t),!t.length)return $(n.$activeItems).removeClass("active"),n.$activeItems=[],void(n.isFocused&&n.showInput());if(i=e&&e.type.toLowerCase(),"mousedown"===i&&n.isShiftDown&&n.$activeItems.length){for(d=n.$control.children(".active:last"),r=Array.prototype.indexOf.apply(n.$control[0].childNodes,[d[0]]),l=Array.prototype.indexOf.apply(n.$control[0].childNodes,[t[0]]),r>l&&(u=r,r=l,l=u),o=r;l>=o;o++)a=n.$control[0].childNodes[o],-1===n.$activeItems.indexOf(a)&&($(a).addClass("active"),n.$activeItems.push(a));e.preventDefault()}else"mousedown"===i&&n.isCtrlDown||"keydown"===i&&this.isShiftDown?t.hasClass("active")?(s=n.$activeItems.indexOf(t[0]),n.$activeItems.splice(s,1),t.removeClass("active")):n.$activeItems.push(t.addClass("active")[0]):($(n.$activeItems).removeClass("active"),n.$activeItems=[t.addClass("active")[0]]);n.hideInput(),this.isFocused||n.focus()}},setActiveOption:function(t,e,n){var i,o,s,r,l,a=this;a.$activeOption&&a.$activeOption.removeClass("active"),a.$activeOption=null,t=$(t),t.length&&(a.$activeOption=t.addClass("active"),(e||!C(e))&&(i=a.$dropdown_content.height(),o=a.$activeOption.outerHeight(!0),e=a.$dropdown_content.scrollTop()||0,s=a.$activeOption.offset().top-a.$dropdown_content.offset().top+e,r=s,l=s-i+o,s+o>i+e?a.$dropdown_content.stop().animate({scrollTop:l},n?a.settings.scrollDuration:0):e>s&&a.$dropdown_content.stop().animate({scrollTop:r},n?a.settings.scrollDuration:0)))},selectAll:function(){var t=this;"single"!==t.settings.mode&&(t.$activeItems=Array.prototype.slice.apply(t.$control.children(":not(input)").addClass("active")),t.$activeItems.length&&(t.hideInput(),t.close()),t.focus())},hideInput:function(){var t=this;t.setTextboxValue(""),t.$control_input.css({opacity:0,position:"absolute",left:t.rtl?1e4:-1e4}),t.isInputHidden=!0},showInput:function(){this.$control_input.css({opacity:1,position:"relative",left:0}),this.isInputHidden=!1},focus:function(){var t=this;t.isDisabled||(t.ignoreFocus=!0,t.$control_input[0].focus(),window.setTimeout(function(){t.ignoreFocus=!1,t.onFocus()},0))},blur:function(){this.$control_input.trigger("blur")},getScoreFunction:function(t){return this.sifter.getScoreFunction(t,this.getSearchOptions())},getSearchOptions:function(){var t=this.settings,e=t.sortField;return"string"==typeof e&&(e={field:e}),{fields:t.searchField,conjunction:t.searchConjunction,sort:e}},search:function(t){var e,n,i,o,s,r=this,l=r.settings,a=this.getSearchOptions();if(l.score&&(s=r.settings.score.apply(this,[t]),"function"!=typeof s))throw new Error('Selectize "score" setting must be a function that returns a function');if(t!==r.lastQuery?(r.lastQuery=t,o=r.sifter.search(t,$.extend(a,{score:s})),r.currentResults=o):o=$.extend(!0,{},r.currentResults),l.hideSelected)for(e=o.items.length-1;e>=0;e--)-1!==r.items.indexOf(x(o.items[e].id))&&o.items.splice(e,1);return o},refreshOptions:function(t){var e,i,o,s,r,l,a,u,d,c,p,f,h,g,v,m;"undefined"==typeof t&&(t=!0);var y=this,b=y.$control_input.val(),w=y.search(b),C=y.$dropdown_content,_=y.$activeOption&&x(y.$activeOption.attr("data-value"));if(s=w.items.length,"number"==typeof y.settings.maxOptions&&(s=Math.min(s,y.settings.maxOptions)),r={},y.settings.optgroupOrder)for(l=y.settings.optgroupOrder,e=0;e<l.length;e++)r[l[e]]=[];else l=[];for(e=0;s>e;e++)for(a=y.options[w.items[e].id],u=y.render("option",a),d=a[y.settings.optgroupField]||"",c=$.isArray(d)?d:[d],i=0,o=c&&c.length;o>i;i++)d=c[i],y.optgroups.hasOwnProperty(d)||(d=""),r.hasOwnProperty(d)||(r[d]=[],l.push(d)),r[d].push(u);for(p=[],e=0,s=l.length;s>e;e++)d=l[e],y.optgroups.hasOwnProperty(d)&&r[d].length?(f=y.render("optgroup_header",y.optgroups[d])||"",f+=r[d].join(""),p.push(y.render("optgroup",$.extend({},y.optgroups[d],{html:f})))):p.push(r[d].join(""));if(C.html(p.join("")),y.settings.highlight&&w.query.length&&w.tokens.length)for(e=0,s=w.tokens.length;s>e;e++)n(C,w.tokens[e].regex);if(!y.settings.hideSelected)for(e=0,s=y.items.length;s>e;e++)y.getOption(y.items[e]).addClass("selected");h=y.settings.create&&w.query.length,h&&(C.prepend(y.render("option_create",{input:b})),m=$(C[0].childNodes[0])),y.hasOptions=w.items.length>0||h,y.hasOptions?(w.items.length>0?(v=_&&y.getOption(_),v&&v.length?g=v:"single"===y.settings.mode&&y.items.length&&(g=y.getOption(y.items[0])),g&&g.length||(g=m&&!y.settings.addPrecedence?y.getAdjacentOption(m,1):C.find("[data-selectable]:first"))):g=m,y.setActiveOption(g),t&&!y.isOpen&&y.open()):(y.setActiveOption(null),t&&y.isOpen&&y.close())},addOption:function(t){var e,n,i,o,s=this;if($.isArray(t))for(e=0,n=t.length;n>e;e++)s.addOption(t[e]);else o=x(t[s.settings.valueField]),o&&!s.options.hasOwnProperty(o)&&(s.userOptions[o]=!0,s.options[o]=t,s.lastQuery=null,s.trigger("option_add",o,t))},addOptionGroup:function(t,e){this.optgroups[t]=e,this.trigger("optgroup_add",t,e)},updateOption:function(t,e){var n=this,i,o,s,r,l,a;if(t=x(t),s=x(e[n.settings.valueField]),n.options.hasOwnProperty(t)){if(!s)throw new Error("Value must be set in option data");s!==t&&(delete n.options[t],r=n.items.indexOf(t),-1!==r&&n.items.splice(r,1,s)),n.options[s]=e,l=n.renderCache.item,a=n.renderCache.option,C(l)&&(delete l[t],delete l[s]),C(a)&&(delete a[t],delete a[s]),-1!==n.items.indexOf(s)&&(i=n.getItem(t),o=$(n.render("item",e)),i.hasClass("active")&&o.addClass("active"),i.replaceWith(o)),n.isOpen&&n.refreshOptions(!1)}},removeOption:function(t){var e=this;t=x(t),delete e.userOptions[t],delete e.options[t],e.lastQuery=null,e.trigger("option_remove",t),e.removeItem(t)},clearOptions:function(){var t=this;t.loadedSearches={},t.userOptions={},t.options=t.sifter.items={},t.lastQuery=null,t.trigger("option_clear"),t.clear()},getOption:function(t){return this.getElementWithValue(t,this.$dropdown_content.find("[data-selectable]"))},getAdjacentOption:function(t,e){var n=this.$dropdown.find("[data-selectable]"),i=n.index(t)+e;return i>=0&&i<n.length?n.eq(i):$()},getElementWithValue:function(t,e){if(t=x(t))for(var n=0,i=e.length;i>n;n++)if(e[n].getAttribute("data-value")===t)return $(e[n]);return $()},getItem:function(t){return this.getElementWithValue(t,this.$control.children())},addItem:function(t){F(this,["change"],function(){var e,n,i=this,o=i.settings.mode,s,r,l,a;return t=x(t),-1!==i.items.indexOf(t)?void("single"===o&&i.close()):void(i.options.hasOwnProperty(t)&&("single"===o&&i.clear(),"multi"===o&&i.isFull()||(e=$(i.render("item",i.options[t])),i.items.splice(i.caretPos,0,t),i.insertAtCaret(e),i.refreshState(),i.isSetup&&(l=i.$dropdown_content.find("[data-selectable]"),n=i.getOption(t),a=i.getAdjacentOption(n,1).attr("data-value"),i.refreshOptions(i.isFocused&&"single"!==o),a&&i.setActiveOption(i.getOption(a)),!l.length||null!==i.settings.maxItems&&i.items.length>=i.settings.maxItems?i.close():i.positionDropdown(),i.updatePlaceholder(),i.trigger("item_add",t,e),i.updateOriginalInput()))))})},removeItem:function(t){var e=this,n,i,o;n="object"==typeof t?t:e.getItem(t),t=x(n.attr("data-value")),i=e.items.indexOf(t),-1!==i&&(n.remove(),n.hasClass("active")&&(o=e.$activeItems.indexOf(n[0]),e.$activeItems.splice(o,1)),e.items.splice(i,1),e.lastQuery=null,!e.settings.persist&&e.userOptions.hasOwnProperty(t)&&e.removeOption(t),i<e.caretPos&&e.setCaret(e.caretPos-1),e.refreshState(),e.updatePlaceholder(),e.updateOriginalInput(),e.positionDropdown(),e.trigger("item_remove",t))},createItem:function(){var t=this,e=$.trim(t.$control_input.val()||""),n=t.caretPos;if(!e.length)return!1;t.lock();var i="function"==typeof t.settings.create?this.settings.create:function(e){var n={};return n[t.settings.labelField]=e,n[t.settings.valueField]=e,n},o=S(function(e){if(t.unlock(),e&&"object"==typeof e){var i=x(e[t.settings.valueField]);i&&(t.setTextboxValue(""),t.addOption(e),t.setCaret(n),t.addItem(i),t.refreshOptions("single"!==t.settings.mode))}}),s=i.apply(this,[e,o]);return"undefined"!=typeof s&&o(s),!0},refreshItems:function(){if(this.lastQuery=null,this.isSetup)for(var t=0;t<this.items.length;t++)this.addItem(this.items);this.refreshState(),this.updateOriginalInput()},refreshState:function(){var t=this,e=t.isRequired&&!t.items.length;e||(t.isInvalid=!1),t.$control_input.prop("required",e),t.refreshClasses()},refreshClasses:function(){var t=this,e=t.isFull(),n=t.isLocked;t.$wrapper.toggleClass("rtl",t.rtl),t.$control.toggleClass("focus",t.isFocused).toggleClass("disabled",t.isDisabled).toggleClass("required",t.isRequired).toggleClass("invalid",t.isInvalid).toggleClass("locked",n).toggleClass("full",e).toggleClass("not-full",!e).toggleClass("input-active",t.isFocused&&!t.isInputHidden).toggleClass("dropdown-active",t.isOpen).toggleClass("has-options",!$.isEmptyObject(t.options)).toggleClass("has-items",t.items.length>0),t.$control_input.data("grow",!e&&!n)},isFull:function(){return null!==this.settings.maxItems&&this.items.length>=this.settings.maxItems},updateOriginalInput:function(){var t,e,n,i=this;if("select"===i.$input[0].tagName.toLowerCase()){for(n=[],t=0,e=i.items.length;e>t;t++)n.push('<option value="'+_(i.items[t])+'" selected="selected"></option>');n.length||this.$input.attr("multiple")||n.push('<option value="" selected="selected"></option>'),i.$input.html(n.join(""))}else i.$input.val(i.getValue());i.isSetup&&i.trigger("change",i.$input.val())},updatePlaceholder:function(){if(this.settings.placeholder){var t=this.$control_input;this.items.length?t.removeAttr("placeholder"):t.attr("placeholder",this.settings.placeholder),t.triggerHandler("update")}},open:function(){var t=this;t.isLocked||t.isOpen||"multi"===t.settings.mode&&t.isFull()||(t.focus(),t.isOpen=!0,t.refreshState(),t.$dropdown.css({visibility:"hidden",display:"block"}),t.positionDropdown(),t.$dropdown.css({visibility:"visible"}),t.trigger("dropdown_open",t.$dropdown))},close:function(){var t=this,e=t.isOpen;"single"===t.settings.mode&&t.items.length&&t.hideInput(),t.isOpen=!1,t.$dropdown.hide(),t.setActiveOption(null),t.refreshState(),e&&t.trigger("dropdown_close",t.$dropdown)},positionDropdown:function(){var t=this.$control,e="body"===this.settings.dropdownParent?t.offset():t.position();e.top+=t.outerHeight(!0),this.$dropdown.css({width:t.outerWidth(),top:e.top,left:e.left})},clear:function(){var t=this;t.items.length&&(t.$control.children(":not(input)").remove(),t.items=[],t.setCaret(0),t.updatePlaceholder(),t.updateOriginalInput(),t.refreshState(),t.showInput(),t.trigger("clear"))},insertAtCaret:function(t){var e=Math.min(this.caretPos,this.items.length);0===e?this.$control.prepend(t):$(this.$control[0].childNodes[e]).before(t),this.setCaret(e+1)},deleteSelection:function(t){var e,n,i,o,s,r,l,a,u,d=this;if(i=t&&t.keyCode===f?-1:1,o=D(d.$control_input[0]),d.$activeOption&&!d.settings.hideSelected&&(l=d.getAdjacentOption(d.$activeOption,-1).attr("data-value")),s=[],d.$activeItems.length){for(u=d.$control.children(".active:"+(i>0?"last":"first")),r=d.$control.children(":not(input)").index(u),i>0&&r++,e=0,n=d.$activeItems.length;n>e;e++)s.push($(d.$activeItems[e]).attr("data-value"));t&&(t.preventDefault(),t.stopPropagation())}else(d.isFocused||"single"===d.settings.mode)&&d.items.length&&(0>i&&0===o.start&&0===o.length?s.push(d.items[d.caretPos-1]):i>0&&o.start===d.$control_input.val().length&&s.push(d.items[d.caretPos]));if(!s.length||"function"==typeof d.settings.onDelete&&d.settings.onDelete.apply(d,[s])===!1)return!1;for("undefined"!=typeof r&&d.setCaret(r);s.length;)d.removeItem(s.pop());return d.showInput(),d.positionDropdown(),d.refreshOptions(!0),l&&(a=d.getOption(l),a.length&&d.setActiveOption(a)),!0},advanceSelection:function(t,e){var n,i,o,s,r,l,a=this;0!==t&&(a.rtl&&(t*=-1),n=t>0?"last":"first",i=D(a.$control_input[0]),a.isFocused&&!a.isInputHidden?(s=a.$control_input.val().length,r=0>t?0===i.start&&0===i.length:i.start===s,r&&!s&&a.advanceCaret(t,e)):(l=a.$control.children(".active:"+n),l.length&&(o=a.$control.children(":not(input)").index(l),a.setActiveItem(null),a.setCaret(t>0?o+1:o))))},advanceCaret:function(t,e){var n=this,i,o;0!==t&&(i=t>0?"next":"prev",n.isShiftDown?(o=n.$control_input[i](),o.length&&(n.hideInput(),n.setActiveItem(o),e&&e.preventDefault())):n.setCaret(n.caretPos+t))},setCaret:function(t){var e=this;t="single"===e.settings.mode?e.items.length:Math.max(0,Math.min(e.items.length,t));var n,i,o,s,r;for(s=e.$control.children(":not(input)"),n=0,i=s.length;i>n;n++)r=$(s[n]).detach(),t>n?e.$control_input.before(r):e.$control.append(r);e.caretPos=t},lock:function(){this.close(),this.isLocked=!0,this.refreshState()},unlock:function(){this.isLocked=!1,this.refreshState()},disable:function(){var t=this;t.$input.prop("disabled",!0),t.isDisabled=!0,t.lock()},enable:function(){var t=this;t.$input.prop("disabled",!1),t.isDisabled=!1,t.unlock()},destroy:function(){var t=this,e=t.eventNS,n=t.revertSettings;t.trigger("destroy"),t.off(),t.$wrapper.remove(),t.$dropdown.remove(),t.$input.html("").append(n.$children).removeAttr("tabindex").attr({tabindex:n.tabindex}).show(),$(window).off(e),$(document).off(e),$(document.body).off(e),delete t.$input[0].selectize},render:function(t,e){var n,i,o,s="",r=!1,l=this,a=/^[\t ]*<([a-z][a-z0-9\-_]*(?:\:[a-z][a-z0-9\-_]*)?)/i;return("option"===t||"item"===t)&&(n=x(e[l.settings.valueField]),r=!!n),r&&(C(l.renderCache[t])||(l.renderCache[t]={}),l.renderCache[t].hasOwnProperty(n))?l.renderCache[t][n]:(s=l.settings.render[t].apply(this,[e,_]),("option"===t||"option_create"===t)&&(s=s.replace(a,"<$1 data-selectable")),"optgroup"===t&&(i=e[l.settings.optgroupValueField]||"",s=s.replace(a,'<$1 data-group="'+O(_(i))+'"')),("option"===t||"item"===t)&&(s=s.replace(a,'<$1 data-value="'+O(_(n||""))+'"')),r&&(l.renderCache[t][n]=s),s)}}),T.count=0,T.defaults={plugins:[],delimiter:",",persist:!0,diacritics:!0,create:!1,createOnBlur:!1,highlight:!0,openOnFocus:!0,maxOptions:1e3,maxItems:null,hideSelected:null,addPrecedence:!1,preload:!1,scrollDuration:60,loadThrottle:300,dataAttr:"data-data",optgroupField:"optgroup",valueField:"value",labelField:"text",optgroupLabelField:"label",optgroupValueField:"value",optgroupOrder:null,sortField:"$order",searchField:["text"],searchConjunction:"and",mode:null,wrapperClass:"selectize-control",inputClass:"selectize-input",dropdownClass:"selectize-dropdown",dropdownContentClass:"selectize-dropdown-content",dropdownParent:null,render:{}},$.fn.selectize=function(t){var e=$.fn.selectize.defaults,n=$.extend({},e,t),i=n.dataAttr,o=n.labelField,s=n.valueField,r=n.optgroupField,l=n.optgroupLabelField,a=n.optgroupValueField,u=function(t,e){var i,r,l,a,u=$.trim(t.val()||"");
if(u.length){for(l=u.split(n.delimiter),i=0,r=l.length;r>i;i++)a={},a[o]=l[i],a[s]=l[i],e.options[l[i]]=a;e.items=l}},d=function(t,e){var n,u,d,c,p=0,f=e.options,h=function(t){var e=i&&t.attr(i);return"string"==typeof e&&e.length?JSON.parse(e):null},g=function(t,n){var i,l;if(t=$(t),i=t.attr("value")||"",i.length){if(f.hasOwnProperty(i))return void(n&&(f[i].optgroup?$.isArray(f[i].optgroup)?f[i].optgroup.push(n):f[i].optgroup=[f[i].optgroup,n]:f[i].optgroup=n));l=h(t)||{},l[o]=l[o]||t.text(),l[s]=l[s]||i,l[r]=l[r]||n,l.$order=++p,f[i]=l,t.is(":selected")&&e.items.push(i)}},v=function(t){var n,i,o,s,r;for(t=$(t),o=t.attr("label"),o&&(s=h(t)||{},s[l]=o,s[a]=o,e.optgroups[o]=s),r=$("option",t),n=0,i=r.length;i>n;n++)g(r[n],o)};for(e.maxItems=t.attr("multiple")?null:1,c=t.children(),n=0,u=c.length;u>n;n++)d=c[n].tagName.toLowerCase(),"optgroup"===d?v(c[n]):"option"===d&&g(c[n])};return this.each(function(){if(!this.selectize){var n,i=$(this),o=this.tagName.toLowerCase(),s={placeholder:i.children('option[value=""]').text()||i.attr("placeholder"),options:{},optgroups:{},items:[]};"select"===o?d(i,s):u(i,s),n=new T(i,$.extend(!0,{},e,s,t)),i.data("selectize",n),i.addClass("selectized")}})},$.fn.selectize.defaults=T.defaults,T.define("drag_drop",function(t){if(!$.fn.sortable)throw new Error('The "drag_drop" plugin requires jQuery UI "sortable".');if("multi"===this.settings.mode){var e=this;e.lock=function(){var t=e.lock;return function(){var n=e.$control.data("sortable");return n&&n.disable(),t.apply(e,arguments)}}(),e.unlock=function(){var t=e.unlock;return function(){var n=e.$control.data("sortable");return n&&n.enable(),t.apply(e,arguments)}}(),e.setup=function(){var t=e.setup;return function(){t.apply(this,arguments);var n=e.$control.sortable({items:"[data-value]",forcePlaceholderSize:!0,disabled:e.isLocked,start:function(t,e){e.placeholder.css("width",e.helper.css("width")),n.css({overflow:"visible"})},stop:function(){n.css({overflow:"hidden"});var t=e.$activeItems?e.$activeItems.slice():null,i=[];n.children("[data-value]").each(function(){i.push($(this).attr("data-value"))}),e.setValue(i),e.setActiveItem(t)}})}}()}}),T.define("dropdown_header",function(t){var e=this;t=$.extend({title:"Untitled",headerClass:"selectize-dropdown-header",titleRowClass:"selectize-dropdown-header-title",labelClass:"selectize-dropdown-header-label",closeClass:"selectize-dropdown-header-close",html:function(t){return'<div class="'+t.headerClass+'"><div class="'+t.titleRowClass+'"><span class="'+t.labelClass+'">'+t.title+'</span><a href="javascript:void(0)" class="'+t.closeClass+'">&times;</a></div></div>'}},t),e.setup=function(){var n=e.setup;return function(){n.apply(e,arguments),e.$dropdown_header=$(t.html(t)),e.$dropdown.prepend(e.$dropdown_header)}}()}),T.define("optgroup_columns",function(t){var e=this;t=$.extend({equalizeWidth:!0,equalizeHeight:!0},t),this.getAdjacentOption=function(t,e){var n=t.closest("[data-group]").find("[data-selectable]"),i=n.index(t)+e;return i>=0&&i<n.length?n.eq(i):$()},this.onKeyDown=function(){var t=e.onKeyDown;return function(n){var i,o,s,r;return!this.isOpen||n.keyCode!==u&&n.keyCode!==c?t.apply(this,arguments):(e.ignoreHover=!0,r=this.$activeOption.closest("[data-group]"),i=r.find("[data-selectable]").index(this.$activeOption),r=n.keyCode===u?r.prev("[data-group]"):r.next("[data-group]"),s=r.find("[data-selectable]"),o=s.eq(Math.min(s.length-1,i)),void(o.length&&this.setActiveOption(o)))}}();var n=function(){var n,i,o,s,r,l,a;if(a=$("[data-group]",e.$dropdown_content),i=a.length,i&&e.$dropdown_content.width()){if(t.equalizeHeight){for(o=0,n=0;i>n;n++)o=Math.max(o,a.eq(n).height());a.css({height:o})}t.equalizeWidth&&(l=e.$dropdown_content.innerWidth(),s=Math.round(l/i),a.css({width:s}),i>1&&(r=l-s*(i-1),a.eq(i-1).css({width:r})))}};(t.equalizeHeight||t.equalizeWidth)&&(k.after(this,"positionDropdown",n),k.after(this,"refreshOptions",n))}),T.define("remove_button",function(t){if("single"!==this.settings.mode){t=$.extend({label:"&times;",title:"Remove",className:"remove",append:!0},t);var e=this,n='<a href="javascript:void(0)" class="'+t.className+'" tabindex="-1" title="'+_(t.title)+'">'+t.label+"</a>",i=function(t,e){var n=t.search(/(<\/[^>]+>\s*)$/);return t.substring(0,n)+e+t.substring(n)};this.setup=function(){var o=e.setup;return function(){if(t.append){var s=e.settings.render.item;e.settings.render.item=function(t){return i(s.apply(this,arguments),n)}}o.apply(this,arguments),this.$control.on("click","."+t.className,function(t){if(t.preventDefault(),!e.isLocked){var n=$(t.target).parent();e.setActiveItem(n),e.deleteSelection()&&e.setCaret(e.items.length)}})}}()}}),T.define("restore_on_backspace",function(t){var e=this;t.text=t.text||function(t){return t[this.settings.labelField]},this.onKeyDown=function(n){var i=e.onKeyDown;return function(e){var n,o;return e.keyCode===f&&""===this.$control_input.val()&&!this.$activeItems.length&&(n=this.caretPos-1,n>=0&&n<this.items.length)?(o=this.options[this.items[n]],this.deleteSelection(e)&&(this.setTextboxValue(t.text.apply(this,[o])),this.refreshOptions(!0)),void e.preventDefault()):i.apply(this,arguments)}}()}),T}),function($){"use strict";Selectize.define("remove_button",function(t){if("single"!==this.settings.mode){t=$.extend({label:"&times;",title:"Remove",className:"remove",append:!0},t);var e=this,n='<a href="javascript:void(0)" class="'+t.className+'" tabindex="-1" title="'+t.title+'">'+t.label+"</a>",i=function(t,e){var n=t.search(/(<\/[^>]+>\s*)$/);return t.substring(0,n)+e+t.substring(n)};this.setup=function(){var o=e.setup;return function(){if(t.append){var s=e.settings.render.item;e.settings.render.item=function(t){return i(s.apply(this,arguments),n)}}o.apply(this,arguments),this.$control.on("click","."+t.className,function(t){if(t.preventDefault(),!e.isLocked){var n=$(t.currentTarget).parent();e.setActiveItem(n),e.deleteSelection()&&e.setCaret(e.items.length)}})}}()}})}(jQuery);